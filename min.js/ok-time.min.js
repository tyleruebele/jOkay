/* Copyright (c) 2006-2013 Tyler Uebele * Released under the MIT license. * latest at https://github.com/tyleruebele/jOkay * minified by Google Closure Compiler */
function okTime(c){c=c.replace(/^\s+|\s+$/g,"");var b,a=new Date;if(""==c)return okTime.errno=4,!1;if(/^now/i.exec(c))return a;if(/^(12(00)?n|noon?|midd(ay?)?)/i.exec(c))return a.setSeconds(0),a.setMinutes(0),a.setHours(12),a;if(RegExp("^"+c,"i").test("midnight"))return a.setSeconds(0),a.setMinutes(0),a.setHours(0),a;var d,e;if(b=/^(\d{1,2})(\d{2})?(\d{2})?\s*(am?|pm?)?$/i.exec(c)){c=parseInt(b[1],10);if(23<c)return okTime.errno=1,!1;d=parseInt(b[2],10);if(59<d)return okTime.errno=2,!1;e=parseInt(b[3],
10);if(59<e)return okTime.errno=3,!1;b[4]&&(c+=-1<b[4].toLowerCase().indexOf("p")?12:0,12==c&&(c=0));a.setSeconds(e||0);a.setMinutes(d||0);a.setHours(c);return a}if(b=/^(\d{1,2}):(\d{1,2})(:(\d{1,2}))?\s*(am?|pm?)?$/i.exec(c)){c=parseInt(b[1],10);if(23<c)return okTime.errno=1,!1;d=parseInt(b[2],10);if(59<d)return okTime.errno=2,!1;e=parseInt(b[4],10);if(59<e)return okTime.errno=3,!1;b[5]&&(c+=-1<b[5].toLowerCase().indexOf("p")?12:0,12==c&&(c=0));a.setSeconds(e||0);a.setMinutes(d||0);a.setHours(c);
return a}if(b=Date.parse(c))return a.setSeconds(0),a.setMinutes(0),a.setHours(0),a.setDate(1),a.setFullYear(1970),a.setMonth(0),a.setMilliseconds(b),a;okTime.errno=okTime.errors.length;return!1}
okTime.blur=function(c,b,a){"undefined"===typeof a&&(a=!!b.className.match(/js-ok-time-24/));b.className=b.className.replace(okTime.errorClass,"");b.title="";""!=b.value.replace(/^\s+|\s+$/g,"")&&(c=okTime(b.value),!1===c?(b.title=okTime.errors[okTime.errno],b.className+=" "+okTime.errorClass):(b.title="",b.value=okTime.format(c,a)))};
okTime.key=function(c,b,a){"undefined"===typeof a&&(a=!!b.className.match(/js-ok-time-24/));var d;switch(c.keyCode?c.keyCode:c.which){case 38:d=okTime(b.value||"now");if(!1===d)break;c.shiftKey?d.setHours(d.getHours()+1):d.setMinutes(d.getMinutes()+1);b.value=okTime.format(d,a);b.className=b.className.replace(okTime.errorClass,"");break;case 40:d=okTime(b.value||"now");if(!1===d)break;c.shiftKey?d.setHours(d.getHours()-1):d.setMinutes(d.getMinutes()-1);b.value=okTime.format(d,a);b.className=b.className.replace(okTime.errorClass,
"");break;case 39:""==b.value&&(b.value=okTime.format(new Date,a))}return!0};
okTime.init=function(){for(var c=document.querySelectorAll(okTime.query),b=c.length-1;0<=b;b--)"text"==c[b].type&&(window.addEventListener?(c[b].addEventListener("blur",function(a){okTime.blur(a,this)}),c[b].addEventListener("keyup",function(a){okTime.key(a,this)})):window.attachEvent&&(c[b].attachEvent("onblur",function(a){a=a||window.event;okTime.blur(a,a.target||a.srcElement)}),c[b].attachEvent("onkeyup",function(a){a=a||window.event;okTime.key(a,a.target||a.srcElement)})))};
okTime.format=function(c,b){var a=c.getHours(),d=String(c.getMinutes()),e=String(c.getSeconds()),f="";b?(a=String(a),a=1===a.length?"0"+a:a):(f=11<a?"pm":"am",a%=12,0==a&&(a=12),a=String(a));d=1===d.length?"0"+d:d;e=1===e.length?"0"+e:e;return a+":"+d+":"+e+f};okTime.errno=0;okTime.errors="Time Validation Passed;Invalid Hour;Invalid Minute;Invalid Second;Empty String;Time Validation Failed".split(";");okTime.query="input[type=time],input.js-ok-time,input.js-ok-time-12,input.js-ok-time-24";
okTime.errorClass="js-ok-time-error";window.addEventListener?window.addEventListener("load",okTime.init,!1):window.attachEvent&&window.attachEvent("onload",okTime.init);
